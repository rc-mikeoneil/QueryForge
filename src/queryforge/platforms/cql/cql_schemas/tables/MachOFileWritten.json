{
  "table": "MachOFileWritten",
  "category": "endpoint_file",
  "description": "Mach-O (Mach Object) file write events for macOS executables and libraries. Captures metadata and hashes for Mac binaries written to disk, essential for macOS malware detection and threat hunting.",
  "source_url": "https://falcon.crowdstrike.com/documentation/84/falcon-data-replicator-guide",
  "columns": [
    {
      "name": "event_simpleName",
      "type": "string",
      "description": "Event type identifier",
      "required": true,
      "example_values": ["MachOFileWritten"]
    },
    {
      "name": "aid",
      "type": "string",
      "description": "Agent ID - unique identifier for the endpoint",
      "required": true,
      "common_usage": ["grouping", "filtering", "correlation"]
    },
    {
      "name": "cid",
      "type": "string",
      "description": "Customer ID - unique identifier for the CrowdStrike tenant",
      "required": true,
      "common_usage": ["grouping", "filtering"]
    },
    {
      "name": "event_platform",
      "type": "string",
      "description": "Operating system platform",
      "required": true,
      "example_values": ["Mac"],
      "common_usage": ["filtering"]
    },
    {
      "name": "ComputerName",
      "type": "string",
      "description": "Hostname of the endpoint",
      "searchable": true,
      "common_usage": ["display", "filtering", "grouping"]
    },
    {
      "name": "UserName",
      "type": "string",
      "description": "Username associated with the file write",
      "searchable": true,
      "common_usage": ["filtering", "user behavior analysis"]
    },
    {
      "name": "UID",
      "type": "string",
      "description": "Unix User ID",
      "common_usage": ["filtering", "user tracking"]
    },
    {
      "name": "TargetFileName",
      "type": "string",
      "description": "Full path to the written Mach-O file",
      "searchable": true,
      "supports_regex": true,
      "example_values": ["/tmp/malware", "/Users/user/Downloads/app.app"],
      "common_usage": ["filtering", "path-based detection", "staging directory analysis"]
    },
    {
      "name": "FileName",
      "type": "string",
      "description": "Base filename of the written Mach-O file",
      "searchable": true,
      "common_usage": ["filtering", "frequency analysis"]
    },
    {
      "name": "ContextProcessId",
      "type": "long",
      "description": "Falcon's unique process identifier for the writing process",
      "common_usage": ["correlation", "joining with ProcessRollup2"]
    },
    {
      "name": "WritingProcessFileName",
      "type": "string",
      "description": "Base filename of the process that wrote the file",
      "searchable": true,
      "example_values": ["Safari", "curl", "python"],
      "common_usage": ["filtering", "source process analysis"]
    },
    {
      "name": "WritingProcessCommandLine",
      "type": "string",
      "description": "Command line of the writing process",
      "searchable": true,
      "supports_regex": true,
      "common_usage": ["behavioral analysis", "download detection"]
    },
    {
      "name": "MD5HashData",
      "type": "string",
      "description": "MD5 hash of the written Mach-O file",
      "searchable": true,
      "common_usage": ["threat intelligence", "IOC matching"]
    },
    {
      "name": "SHA256HashData",
      "type": "string",
      "description": "SHA256 hash of the written Mach-O file",
      "searchable": true,
      "common_usage": ["threat intelligence", "IOC matching", "malware identification"]
    },
    {
      "name": "SHA1HashData",
      "type": "string",
      "description": "SHA1 hash of the written Mach-O file",
      "searchable": true,
      "common_usage": ["threat intelligence", "IOC matching"]
    },
    {
      "name": "Size",
      "type": "long",
      "description": "File size in bytes",
      "common_usage": ["filtering", "size-based analysis"]
    },
    {
      "name": "SignInfoFlags",
      "type": "long",
      "description": "Bitmask indicating code signature validation results",
      "common_usage": ["signature validation", "unsigned binary detection"]
    },
    {
      "name": "ContextTimeStamp",
      "type": "long",
      "description": "Event timestamp in epoch milliseconds",
      "common_usage": ["temporal analysis", "timeline creation"]
    }
  ],
  "col_count": 18,
  "common_filters": [
    "event_platform=Mac",
    "TargetFileName=/\\/tmp\\//",
    "TargetFileName=/\\/Downloads\\//",
    "WritingProcessFileName=/Safari|curl/i"
  ],
  "common_fields": ["aid", "ComputerName", "TargetFileName", "SHA256HashData", "WritingProcessFileName"],
  "common_operations": [
    "Join with ProcessRollup2 via ContextProcessId for writing process details",
    "Match hashes against threat intelligence feeds",
    "Detect files written to Downloads or /tmp",
    "Identify unsigned or invalidly signed applications",
    "Hunt for macOS malware and adware",
    "Detect downloads from browsers or command-line tools"
  ],
  "generated_at": "2025-11-15T00:00:00Z"
}
