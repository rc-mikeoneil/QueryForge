{
  "table": "NewScriptWritten",
  "category": "endpoint_file",
  "description": "Script file write events (.ps1, .py, .sh, .bat, .cmd, etc.). Captures metadata and hashes for script files written to disk, essential for detecting malicious scripts, persistence mechanisms, and automation tools.",
  "source_url": "https://falcon.crowdstrike.com/documentation/84/falcon-data-replicator-guide",
  "columns": [
    {
      "name": "event_simpleName",
      "type": "string",
      "description": "Event type identifier",
      "required": true,
      "example_values": ["NewScriptWritten"]
    },
    {
      "name": "aid",
      "type": "string",
      "description": "Agent ID - unique identifier for the endpoint",
      "required": true,
      "common_usage": ["grouping", "filtering", "correlation"]
    },
    {
      "name": "cid",
      "type": "string",
      "description": "Customer ID - unique identifier for the CrowdStrike tenant",
      "required": true,
      "common_usage": ["grouping", "filtering"]
    },
    {
      "name": "event_platform",
      "type": "string",
      "description": "Operating system platform",
      "required": true,
      "example_values": ["Win", "Mac", "Lin"],
      "common_usage": ["filtering"]
    },
    {
      "name": "ComputerName",
      "type": "string",
      "description": "Hostname of the endpoint",
      "searchable": true,
      "common_usage": ["display", "filtering", "grouping"]
    },
    {
      "name": "UserName",
      "type": "string",
      "description": "Username associated with the file write",
      "searchable": true,
      "common_usage": ["filtering", "user behavior analysis"]
    },
    {
      "name": "TargetFileName",
      "type": "string",
      "description": "Full path to the written script file",
      "searchable": true,
      "supports_regex": true,
      "example_values": ["\\Temp\\payload.ps1", "/tmp/exploit.sh", "\\startup\\persist.bat"],
      "common_usage": ["filtering", "path-based detection", "persistence detection"]
    },
    {
      "name": "FileName",
      "type": "string",
      "description": "Base filename of the written script file",
      "searchable": true,
      "example_values": ["payload.ps1", "exploit.sh", "persist.bat"],
      "common_usage": ["filtering", "extension analysis"]
    },
    {
      "name": "ContextProcessId",
      "type": "long",
      "description": "Falcon's unique process identifier for the writing process",
      "common_usage": ["correlation", "joining with ProcessRollup2"]
    },
    {
      "name": "WritingProcessFileName",
      "type": "string",
      "description": "Base filename of the process that wrote the file",
      "searchable": true,
      "example_values": ["powershell.exe", "cmd.exe", "vim", "notepad.exe"],
      "common_usage": ["filtering", "source process analysis"]
    },
    {
      "name": "MD5HashData",
      "type": "string",
      "description": "MD5 hash of the written script file",
      "searchable": true,
      "common_usage": ["threat intelligence", "IOC matching"]
    },
    {
      "name": "SHA256HashData",
      "type": "string",
      "description": "SHA256 hash of the written script file",
      "searchable": true,
      "common_usage": ["threat intelligence", "IOC matching"]
    },
    {
      "name": "ZoneIdentifier",
      "type": "string",
      "description": "Mark of the Web (MOTW) zone identifier (Windows)",
      "searchable": true,
      "common_usage": ["downloaded file detection"]
    },
    {
      "name": "ContextTimeStamp",
      "type": "long",
      "description": "Event timestamp in epoch milliseconds",
      "common_usage": ["temporal analysis", "timeline creation"]
    }
  ],
  "col_count": 14,
  "common_filters": [
    "TargetFileName=/\\.ps1$|\\.bat$|\\.cmd$|\\.sh$|\\.py$/i",
    "TargetFileName=/\\\\startup\\\\|\\\\programdata\\\\/i",
    "ZoneIdentifier=3"
  ],
  "common_fields": ["aid", "ComputerName", "TargetFileName", "WritingProcessFileName"],
  "common_operations": [
    "Join with ProcessRollup2 via ContextProcessId for writing process details",
    "Detect scripts written to persistence locations (startup, cron, etc.)",
    "Identify downloaded scripts (ZoneIdentifier=3)",
    "Correlate with ScriptControl or CommandHistory for execution",
    "Hunt for PowerShell-based malware and frameworks",
    "Detect obfuscated or encoded scripts"
  ],
  "generated_at": "2025-11-15T00:00:00Z"
}
