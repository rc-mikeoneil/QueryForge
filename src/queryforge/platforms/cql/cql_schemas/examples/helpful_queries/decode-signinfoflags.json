{
  "id": "decode-signinfoflags",
  "title": "Decode SignInfoFlags",
  "source_file": "Queries-Only/Helpful-CQL-Queries/Decode SignInfoFlags.md",
  "category": "helpful_query",
  "subcategory": "process",
  "description": "",
  "mitre_attack": null,
  "event_types": [
    "ProcessRollup2"
  ],
  "functions_used": [],
  "operators_used": [
    "=",
    "|"
  ],
  "fields_referenced": [
    "SignInfoFlags",
    "UserSid",
    "field",
    "output"
  ],
  "correlation_patterns": [],
  "difficulty": "basic",
  "query_type": "utility",
  "platforms": [
    "Win"
  ],
  "use_case": "Utility query for Decode SignInfoFlags",
  "query": "#event_simpleName=ProcessRollup2 UserSid=/^S-1-5-21-/ SignInfoFlags=*\n| bitfield:extractFlags(\n field=SignInfoFlags,\n  output=[\n    [0,SIGNATURE_FLAG_SELF_SIGNED],\n    [1,SIGNATURE_FLAG_MS_SIGNED],\n    [2,SIGNATURE_FLAG_TEST_SIGNED],\n    [3,SIGNATURE_FLAG_MS_CROSS_SIGNED],\n    [4,SIGNATURE_FLAG_CAT_SIGNED],\n    [5,SIGNATURE_FLAG_DRM_SIGNED],\n    [6,SIGNATURE_FLAG_DRM_TEST_SIGNED],\n    [7,SIGNATURE_FLAG_MS_CAT_SIGNED],\n    [8,SIGNATURE_FLAG_CATALOGS_RELOADED],\n    [9,SIGNATURE_FLAG_NO_SIGNATURE],\n    [10,SIGNATURE_FLAG_INVALID_SIGN_CHAIN],\n    [11,SIGNATURE_FLAG_SIGN_HASH_MISMATCH],\n    [12,SIGNATURE_FLAG_NO_CODE_KEY_USAGE],\n    [13,SIGNATURE_FLAG_NO_PAGE_HASHES],\n    [14,SIGNATURE_FLAG_FAILED_CERT_CHECK],\n    [15,SIGNATURE_FLAG_NO_EMBEDDED_CERT],\n    [16,SIGNATURE_FLAG_FAILED_COPY_KEYS],\n    [17,SIGNATURE_FLAG_UNKNOWN_ERROR],\n    [18,SIGNATURE_FLAG_HAS_VALID_SIGNATURE],\n    [19,SIGNATURE_FLAG_EMBEDDED_SIGNED],\n    [20,SIGNATURE_FLAG_3RD_PARTY_ROOT],\n    [21,SIGNATURE_FLAG_TRUSTED_BOOT_ROOT],\n    [22,SIGNATURE_FLAG_UEFI_ROOT],\n    [23,SIGNATURE_FLAG_PRS_WIN81_ROOT],\n    [24,SIGNATURE_FLAG_FLIGHT_ROOT],\n    [25,SIGNATURE_FLAG_APPLE_SIGNED],\n    [26,SIGNATURE_FLAG_ESBCACHE],\n    [27,SIGNATURE_FLAG_NO_CACHED_DATA],\n    [28,SIGNATURE_FLAG_CERT_EXPIRED],\n    [29,SIGNATURE_FLAG_CERT_REVOKED]\n])",
  "key_features": [],
  "related_examples": [],
  "tags": [
    "processrollup2",
    "win"
  ]
}