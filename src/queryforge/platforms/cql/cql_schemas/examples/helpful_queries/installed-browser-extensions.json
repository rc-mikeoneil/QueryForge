{
  "id": "installed-browser-extensions",
  "title": "Installed Browser Extensions",
  "source_file": "Queries-Only/Helpful-CQL-Queries/Installed Browser Extensions.md",
  "category": "helpful_query",
  "subcategory": null,
  "description": "Aggregate by Extension",
  "mitre_attack": null,
  "event_types": [
    "InstalledBrowserExtension"
  ],
  "functions_used": [
    "count",
    "format",
    "groupBy",
    "sort",
    "test"
  ],
  "operators_used": [
    "!=",
    "<",
    "=",
    "and",
    "in",
    "|"
  ],
  "fields_referenced": [
    "BrowserName",
    "as",
    "distinct",
    "field",
    "function",
    "limit",
    "order"
  ],
  "correlation_patterns": [],
  "difficulty": "intermediate",
  "query_type": "analysis",
  "platforms": [
    "Lin"
  ],
  "use_case": "Aggregate by Extension",
  "query": "// Get browser extension event\n#event_simpleName=InstalledBrowserExtension BrowserExtensionId!=\"no-extension-available\"\n\n// Aggregate by event_platform, BrowserName, ExtensionID and ExtensionName\n| groupBy([event_platform, BrowserName, BrowserExtensionId, BrowserExtensionName], function=([count(aid, distinct=true, as=TotalEndpoints)]))\n\n// Check to see if the extension is installed on fewer than 50 systems\n| test(TotalEndpoints<50)\n\n// Create a link to the Chrome Extension Store\n| format(\"[See Extension](https://chromewebstore.google.com/detail/%s)\", field=[BrowserExtensionId], as=\"Chrome Store Link\")\n\n// Sort in descending order\n| sort(order=desc, TotalEndpoints, limit=1000)\n\n// Convert the browser name from decimal to human-readable\n| case{\n    BrowserName=\"3\" | BrowserName:=\"Chrome\";\n    BrowserName=\"4\" | BrowserName:=\"Edge\";\n    *;\n}",
  "key_features": [],
  "related_examples": [],
  "tags": [
    "installedbrowserextension",
    "lin"
  ]
}