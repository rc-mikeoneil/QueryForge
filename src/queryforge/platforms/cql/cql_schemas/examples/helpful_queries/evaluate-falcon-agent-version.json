{
  "id": "evaluate-falcon-agent-version",
  "title": "Evaluate Falcon Agent Version",
  "source_file": "Queries-Only/Helpful-CQL-Queries/Evaluate Falcon Agent Version.md",
  "category": "helpful_query",
  "subcategory": null,
  "description": "",
  "mitre_attack": null,
  "event_types": [
    "OsVersionInfo"
  ],
  "functions_used": [],
  "operators_used": [
    "<",
    "=",
    ">",
    "and",
    "|"
  ],
  "fields_referenced": [
    "AgentVersion",
    "function",
    "majorVersion",
    "minorVersion"
  ],
  "correlation_patterns": [],
  "difficulty": "basic",
  "query_type": "utility",
  "platforms": [
    "Win"
  ],
  "use_case": "Utility query for Evaluate Falcon Agent Version",
  "query": "#event_simpleName=OsVersionInfo event_platform=Win\n\n| groupby(aid, function=selectLast([AgentVersion, event_platform, @timestamp]))\n| AgentVersion=/(?<majorVersion>\\d+)\\.(?<minorVersion>\\d+)\\.(?<buildNumber>\\d+)\\.\\d+/\n| case{\n\nmajorVersion = 6 AND minorVersion = 42 | buildPolicy := \"Dev Build\";\nmajorVersion = 6 AND minorVersion = 42 | buildPolicy := \"N\";\nmajorVersion = 6 AND minorVersion = 40 | buildPolicy := \"N-1\";\nmajorVersion = 6 AND minorVersion = 39 | buildPolicy := \"N-2\";\nmajorVersion = 6 AND minorVersion < 39 | buildPolicy := \"N-3+\";\nmajorVersion = 0 | buildPolicy := \"Sensor Uninitialized\";\n}",
  "key_features": [],
  "related_examples": [],
  "tags": [
    "osversioninfo",
    "win"
  ]
}