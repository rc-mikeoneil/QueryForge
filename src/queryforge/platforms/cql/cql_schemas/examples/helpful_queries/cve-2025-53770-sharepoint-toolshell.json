{
  "id": "cve-2025-53770-sharepoint-toolshell",
  "title": "CVE-2025-53770 - SharePoint ToolShell",
  "source_file": "Queries-Only/Helpful-CQL-Queries/CVE-2025-53770 - SharePoint ToolShell.md",
  "category": "helpful_query",
  "subcategory": "process",
  "description": "Falcon has native detection/prevention capabilities for this attack sequence. The following looks for:",
  "mitre_attack": null,
  "event_types": [
    "ProcessRollup2"
  ],
  "functions_used": [
    "correlate"
  ],
  "operators_used": [
    "<",
    "<=",
    "=",
    ">",
    "|"
  ],
  "fields_referenced": [
    "FileName",
    "ParentBaseFileName",
    "sequence",
    "within"
  ],
  "correlation_patterns": [
    "correlate",
    "sequence"
  ],
  "difficulty": "expert",
  "query_type": "detection",
  "platforms": [
    "Lin",
    "Win"
  ],
  "use_case": "Falcon has native detection/prevention capabilities for this attack sequence. The following looks for:",
  "query": "// CVE-2025-53770 - WebShell Discovery from w3wp.exe\n\ncorrelate(\n    cmd: {\n        #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"cmd.exe\" ParentBaseFileName=\"w3wp.exe\"\n          } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine],\n    pwsh: {\n        #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"powershell.exe\"\n          | aid <=> cmd.aid\n          | ParentProcessId <=> cmd.TargetProcessId\n          } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine],\n    aspx: {\n        #event_simpleName=/^(NewScriptWritten|WebScriptFileWritten)$/ event_platform=Win FileName=/\\.aspx/i\n          | aid <=> cmd.aid\n          | ContextProcessId <=> pwsh.TargetProcessId\n          } include: [aid, ComputerName, TargetFileName],\nsequence=true, within=5m)",
  "key_features": [
    "Uses correlate, sequence for correlation",
    "Advanced correlation techniques"
  ],
  "related_examples": [],
  "tags": [
    "correlate",
    "lin",
    "processrollup2",
    "win"
  ]
}