{
  "id": "device-driver-discovery",
  "title": "(T1652) Device Driver Discovery",
  "source_file": "Queries-Only/MITRE-ATT&CK-Enterprise/(TA007) Discovery/(T1652) Device Driver Discovery.md",
  "category": "mitre_attack",
  "subcategory": "process",
  "description": "https://attack.mitre.org/techniques/T1652/",
  "mitre_attack": {
    "tactic_code": "TA007",
    "tactic_name": "Discovery",
    "technique_id": "T1652",
    "technique_name": "Device Driver Discovery",
    "sub_technique_id": null
  },
  "event_types": [
    "ProcessRollup2"
  ],
  "functions_used": [],
  "operators_used": [
    "=",
    "or",
    "|"
  ],
  "fields_referenced": [
    "CommandLine",
    "ImageFileName"
  ],
  "correlation_patterns": [],
  "difficulty": "basic",
  "query_type": "utility",
  "platforms": [
    "Lin",
    "Win"
  ],
  "use_case": "https://attack.mitre.org/techniques/T1652/",
  "query": "(#event_simpleName=ProcessRollup2 event_platform=Win (ImageFileName=/\\\\driverquery\\.exe/i OR (ImageFileName=/\\\\sc\\.exe/i CommandLine=/query/i))) OR (#event_simpleName=/^(ProcessRollup2|CommandHistory|ScriptControl)/ event_platform=Win /CurrentControlSet\\\\(Services|HardwareProfiles)/)",
  "key_features": [],
  "related_examples": [],
  "tags": [
    "lin",
    "processrollup2",
    "win"
  ]
}