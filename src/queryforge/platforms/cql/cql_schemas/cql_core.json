{
  "schema_version": "1.0.0",
  "platform": {
    "name": "CrowdStrike Query Language (CQL)",
    "short_name": "cql",
    "version": "2024.1",
    "description": "CrowdStrike's query language for threat hunting and security analytics across Falcon event data"
  },
  "datasets": [
    {
      "name": "events",
      "display_name": "Falcon Events",
      "description": "Primary dataset for endpoint events including process execution, network activity, file operations, and authentication events",
      "event_types": [
        "ProcessRollup2",
        "NetworkConnectIP4",
        "DnsRequest",
        "UserLogon",
        "UserLogonFailed2",
        "DriverLoad",
        "InstalledBrowserExtension",
        "AgentOnline",
        "EndOfProcess",
        "OsVersionInfo"
      ],
      "primary_use_cases": [
        "Threat hunting",
        "Process analysis",
        "Network monitoring",
        "Behavioral detection"
      ],
      "search_type": "#event_simpleName=<event_type>"
    },
    {
      "name": "detections",
      "display_name": "Detections",
      "description": "Security detections and alerts generated by Falcon",
      "event_types": [
        "DetectionSummaryEvent"
      ],
      "primary_use_cases": [
        "Alert analysis",
        "Detection hunting",
        "Incident response"
      ],
      "search_type": "event_simpleName=DetectionSummaryEvent"
    },
    {
      "name": "indicators",
      "display_name": "Indicators",
      "description": "Threat intelligence indicators and IOCs",
      "event_types": [
        "IndicatorEvent"
      ],
      "primary_use_cases": [
        "IOC matching",
        "Threat intelligence",
        "Indicator tracking"
      ],
      "search_type": "event_simpleName=IndicatorEvent"
    }
  ],
  "query_structure": {
    "pattern": "#event_simpleName=<type> [filters] | [functions] | [output]",
    "required_start": "#event_simpleName=",
    "pipe_operator": "|",
    "comment_syntax": "// for single line comments"
  },
  "metadata_fields": {
    "description": "Special metadata fields accessed with # prefix",
    "fields": [
      {
        "name": "#event_simpleName",
        "type": "string",
        "description": "Event type identifier - required for all queries",
        "example": "#event_simpleName=ProcessRollup2"
      },
      {
        "name": "#repo",
        "type": "string",
        "description": "Repository name for multi-repo queries",
        "example": "#repo=\"base_sensor\""
      },
      {
        "name": "#event_platform",
        "type": "string",
        "description": "Platform identifier (Win, Mac, Lin)",
        "example": "#event_platform=Win"
      },
      {
        "name": "#cid",
        "type": "string",
        "description": "Customer ID",
        "example": "#cid=*"
      }
    ]
  },
  "time_handling": {
    "default_field": "@timestamp",
    "epoch_fields": [
      "ContextTimeStamp",
      "ProcessStartTime",
      "PasswordLastSet",
      "BaseTime"
    ],
    "iso_fields": [
      "@timestamp"
    ],
    "time_functions": [
      "now()",
      "formatTime()",
      "formatDuration()",
      "bucket()",
      "timeChart()"
    ],
    "duration_units": {
      "ms": "milliseconds",
      "s": "seconds",
      "m": "minutes",
      "h": "hours",
      "d": "days",
      "w": "weeks"
    }
  },
  "capabilities": {
    "supports_regex": true,
    "supports_wildcards": true,
    "supports_joins": true,
    "supports_aggregation": true,
    "supports_geolocation": true,
    "supports_correlation": true,
    "max_query_length": 10000,
    "default_result_limit": 200
  }
}
