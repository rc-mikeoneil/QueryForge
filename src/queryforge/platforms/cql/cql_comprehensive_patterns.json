{
  "patterns": {
    "process_execution": {
      "description": "Common patterns for process execution events",
      "patterns": [
        {
          "name": "PowerShell Execution",
          "description": "Detect PowerShell process execution",
          "filter": "process_name = 'powershell.exe'",
          "keywords": ["powershell", "ps", "pwsh"]
        },
        {
          "name": "Command Prompt Execution",
          "description": "Detect cmd.exe process execution",
          "filter": "process_name = 'cmd.exe'",
          "keywords": ["cmd", "command prompt", "shell"]
        },
        {
          "name": "Scripting Engines",
          "description": "Detect scripting engine execution",
          "filter": "process_name IN ('wscript.exe', 'cscript.exe', 'mshta.exe')",
          "keywords": ["wscript", "cscript", "mshta", "script"]
        },
        {
          "name": "Encoded Command",
          "description": "Detect encoded PowerShell commands",
          "filter": "command_line contains '-enc' OR command_line contains '-EncodedCommand'",
          "keywords": ["encoded", "base64", "obfuscated"]
        },
        {
          "name": "Suspicious Parent Process",
          "description": "Detect processes spawned by suspicious parents",
          "filter": "parent_process_name IN ('winword.exe', 'excel.exe', 'outlook.exe')",
          "keywords": ["office", "macro", "phishing"]
        }
      ]
    },
    "network_activity": {
      "description": "Common patterns for network-related events",
      "patterns": [
        {
          "name": "Outbound High Ports",
          "description": "Detect connections to uncommon high ports",
          "filter": "destination_port > 49152",
          "keywords": ["network", "connection", "high port", "ephemeral"]
        },
        {
          "name": "External IP Connection",
          "description": "Detect connections to external IPs (not RFC1918)",
          "filter": "destination_ip != '10.*' AND destination_ip != '172.16.*' AND destination_ip != '192.168.*'",
          "keywords": ["external", "internet", "egress"]
        },
        {
          "name": "Rare Protocols",
          "description": "Detect uncommon network protocols",
          "filter": "protocol NOT IN ('tcp', 'udp', 'icmp')",
          "keywords": ["protocol", "unusual", "rare"]
        },
        {
          "name": "DNS Tunneling Indicators",
          "description": "Detect potential DNS tunneling",
          "filter": "protocol = 'dns' AND query_length > 100",
          "keywords": ["dns", "tunnel", "exfiltration"]
        },
        {
          "name": "Beaconing Behavior",
          "description": "Detect regular periodic connections (potential C2)",
          "filter": "event_type = 'network_connection' | stats count by destination_ip, interval(5m)",
          "keywords": ["beacon", "c2", "command and control", "periodic"]
        }
      ]
    },
    "file_operations": {
      "description": "Common patterns for file system events",
      "patterns": [
        {
          "name": "Temp Directory Files",
          "description": "Detect file operations in temp directories",
          "filter": "file_path contains '\\Temp\\' OR file_path contains '\\tmp\\'",
          "keywords": ["temp", "temporary", "staging"]
        },
        {
          "name": "Executable Creation",
          "description": "Detect creation of executable files",
          "filter": "file_name endswith '.exe' AND event_type = 'file_created'",
          "keywords": ["executable", "exe", "binary", "creation"]
        },
        {
          "name": "Suspicious Extensions",
          "description": "Detect files with suspicious double extensions",
          "filter": "file_name =~ /\\.(pdf|doc|xls)\\.(exe|scr|bat|vbs)$/",
          "keywords": ["double extension", "disguise", "masquerade"]
        },
        {
          "name": "System Directory Modifications",
          "description": "Detect file modifications in system directories",
          "filter": "file_path startswith 'C:\\Windows\\System32\\' AND event_type IN ('file_modified', 'file_created')",
          "keywords": ["system", "system32", "windows", "modification"]
        },
        {
          "name": "User Profile Modifications",
          "description": "Detect file operations in user profile directories",
          "filter": "file_path contains '\\AppData\\Roaming\\' OR file_path contains '\\AppData\\Local\\'",
          "keywords": ["appdata", "user profile", "persistence"]
        }
      ]
    },
    "registry_operations": {
      "description": "Common patterns for Windows registry events",
      "patterns": [
        {
          "name": "Run Key Modification",
          "description": "Detect modifications to autorun registry keys",
          "filter": "registry_key contains '\\Run' OR registry_key contains '\\RunOnce'",
          "keywords": ["run key", "autorun", "persistence", "startup"]
        },
        {
          "name": "Service Creation",
          "description": "Detect new service registry entries",
          "filter": "registry_key contains '\\Services\\' AND event_type = 'registry_key_created'",
          "keywords": ["service", "persistence", "registry"]
        },
        {
          "name": "Security Policy Changes",
          "description": "Detect changes to security policy registry keys",
          "filter": "registry_key contains '\\Policies\\' OR registry_key contains '\\SecurityProviders\\'",
          "keywords": ["policy", "security", "configuration"]
        }
      ]
    },
    "authentication": {
      "description": "Common patterns for authentication events",
      "patterns": [
        {
          "name": "Failed Login Attempts",
          "description": "Detect multiple failed authentication attempts",
          "filter": "event_type = 'authentication' AND status = 'failed'",
          "keywords": ["failed login", "authentication", "brute force"]
        },
        {
          "name": "Privileged Account Usage",
          "description": "Detect usage of privileged accounts",
          "filter": "user_name IN ('Administrator', 'root', 'admin') OR user_name contains 'adm-'",
          "keywords": ["privileged", "admin", "elevated"]
        },
        {
          "name": "After Hours Login",
          "description": "Detect logins outside business hours",
          "filter": "event_type = 'authentication' AND (hour(@timestamp) < 6 OR hour(@timestamp) > 18)",
          "keywords": ["after hours", "off hours", "unusual time"]
        }
      ]
    },
    "web_activity": {
      "description": "Common patterns for web/HTTP events",
      "patterns": [
        {
          "name": "Suspicious User Agents",
          "description": "Detect suspicious or automated user agents",
          "filter": "http_user_agent contains 'bot' OR http_user_agent contains 'crawler' OR http_user_agent contains 'scanner'",
          "keywords": ["user agent", "bot", "automation"]
        },
        {
          "name": "SQL Injection Attempts",
          "description": "Detect potential SQL injection in HTTP requests",
          "filter": "http_request contains 'union select' OR http_request contains 'drop table' OR http_request =~ /';.*--/",
          "keywords": ["sql injection", "sqli", "web attack"]
        },
        {
          "name": "Command Injection",
          "description": "Detect potential command injection attempts",
          "filter": "http_request contains '|' OR http_request contains ';' OR http_request contains '&&'",
          "keywords": ["command injection", "web attack", "rce"]
        },
        {
          "name": "Error Responses",
          "description": "Detect HTTP error responses",
          "filter": "http_status >= 400",
          "keywords": ["error", "http error", "failed request"]
        }
      ]
    },
    "lateral_movement": {
      "description": "Common patterns for lateral movement detection",
      "patterns": [
        {
          "name": "Remote Service Creation",
          "description": "Detect remote service creation via SMB",
          "filter": "event_type = 'service_created' AND source_ip EXISTS",
          "keywords": ["lateral movement", "remote service", "smb"]
        },
        {
          "name": "PSExec Usage",
          "description": "Detect PsExec tool usage",
          "filter": "process_name = 'psexec.exe' OR file_name = 'PSEXESVC.exe'",
          "keywords": ["psexec", "sysinternals", "lateral movement"]
        },
        {
          "name": "WMI Remote Execution",
          "description": "Detect WMI remote process execution",
          "filter": "process_name = 'wmic.exe' AND command_line contains '/node:'",
          "keywords": ["wmi", "remote execution", "lateral movement"]
        }
      ]
    }
  },
  "keyword_mapping": {
    "powershell": ["process_name = 'powershell.exe'", "process_name = 'pwsh.exe'"],
    "cmd": ["process_name = 'cmd.exe'"],
    "script": ["process_name IN ('wscript.exe', 'cscript.exe', 'mshta.exe')"],
    "network": ["event_type IN ('network_connection', 'dns_query', 'http_request')"],
    "file": ["event_type IN ('file_created', 'file_modified', 'file_deleted')"],
    "registry": ["event_type IN ('registry_key_created', 'registry_value_set', 'registry_key_deleted')"],
    "process": ["event_type IN ('process_created', 'process_terminated')"],
    "authentication": ["event_type IN ('authentication', 'logon', 'logoff')"],
    "lateral movement": ["event_type IN ('remote_execution', 'service_created') OR process_name IN ('psexec.exe', 'wmic.exe')"],
    "privilege escalation": ["event_type = 'privilege_escalation' OR user_name contains 'admin'"],
    "persistence": ["registry_key contains '\\Run' OR event_type = 'scheduled_task_created'"]
  }
}
